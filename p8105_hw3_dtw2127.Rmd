---
title: "p8105_hw3_dtw2127"
author: "Dee Wang"
date: "18/10/2021"
output: github_document
---

```{r}
library(tidyverse)
knitr::opts_chunk$set(echo = TRUE)
library(p8105.datasets)
```

First we'll load in the instacart data and do an exploration of the dataset.

```{r}
data("instacart")

str(instacart)
```

The instacart dataset contains `r nrow(instacart)` rows of data for `r ncol(instacart)` variables. Key variables include order ID, product ID, add to cart order, user ID, order hour of day, days since prior order, and department. 

There are `r pull(instacart, aisle) %>% unique() %>% length()` aisles. Let's determine which aisle the most items are ordered from. 

```{r}
instacart %>% group_by(aisle, aisle_id) %>% summarize(n_obs = n()) %>% arrange(desc(n_obs)) 
```
The most items are ordered from the fresh vegetables, fresh fruits, and packaged vegetables and fruits aisle.  

We'll make a plot that shows the number of items ordered from each aisle. 

```{r}

instacart %>% group_by(aisle, department) %>% summarize(n_obs = n()) %>% filter(n_obs > 10000) %>% arrange(department) %>% 
  ggplot(aes(x = aisle, y = n_obs)) + 
  geom_bar(stat = "identity") +
  theme(axis.text.x = element_text(angle = 90))

```

Next we'll create a table showing the three most popular items in each of the aisles "baking ingredients", "dog food care", and "packaged vegetables fruits".

```{r}
instacart %>% filter(aisle == c("baking ingredients", "packaged vegetables fruits", "dog food care")) %>% group_by(aisle, product_name) %>% summarize(n_obs = n()) %>% slice_max(order_by = n_obs, n = 3)
```

